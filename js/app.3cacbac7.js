(function(e){function t(t){for(var n,s,o=t[0],c=t[1],u=t[2],l=0,p=[];l<o.length;l++)s=o[l],r[s]&&p.push(r[s][0]),r[s]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);d&&d(t);while(p.length)p.shift()();return i.push.apply(i,u||[]),a()}function a(){for(var e,t=0;t<i.length;t++){for(var a=i[t],n=!0,o=1;o<a.length;o++){var c=a[o];0!==r[c]&&(n=!1)}n&&(i.splice(t--,1),e=s(s.s=a[0]))}return e}var n={},r={app:0},i=[];function s(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=e,s.c=n,s.d=function(e,t,a){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(a,n,function(t){return e[t]}.bind(null,n));return a},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=t,o=o.slice();for(var u=0;u<o.length;u++)t(o[u]);var d=c;i.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"034f":function(e,t,a){"use strict";var n=a("64a9"),r=a.n(n);r.a},"1b93":function(e,t,a){},3540:function(e,t,a){},"3dfa":function(e,t,a){"use strict";var n=a("4ec3"),r=a.n(n);r.a},"4ec3":function(e,t,a){},"56d7":function(e,t,a){"use strict";a.r(t);a("cadf"),a("551c"),a("097d");var n=a("2b0e"),r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app","data-tid":"App"}},[e.state===e.State.INTRO?a("intro-page",{attrs:{moveToGamePage:e.moveToGamePage}}):e._e(),e.state===e.State.GAME?a("game-page",{attrs:{moveToResultPage:e.moveToResultPage}}):e._e(),e.state===e.State.RESULT?a("result-page",{attrs:{score:e.score,moveToGamePage:e.moveToGamePage}}):e._e(),a("placeholder-for-preloading-images-and-font")],1)},i=[],s=a("15b8"),o=a.n(s),c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"intro-page"},[a("img",{staticClass:"intro-page__image responsive-image",attrs:{srcset:"static/images/StartGame.png 501w, static/images/StartGame@2x.png 1002w",sizes:"40vw",src:"static/images/StartGame.png",alt:"картинка из четырёх карт, три из которых показаны рубашкой"}}),a("h1",{staticClass:"intro-page__header header"},[e._v("Memory game")]),a("button",{staticClass:"intro-page__button-new-game button",attrs:{"data-tid":"NewGame-startGame"},on:{click:e.onButtonNewGameClick}},[e._v("\n    Начать игру\n  ")])])},u=[],d={name:"intro-page",props:["moveToGamePage"],methods:{onButtonNewGameClick:function(e){e.target.blur(),this.moveToGamePage()}}},l=d,p=(a("d410"),a("2877")),m=Object(p["a"])(l,c,u,!1,null,"849eb3ec",null),f=m.exports,h=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.game?a("div",{staticClass:"game-page"},[a("game-page-menu",e._b({ref:"menu",staticClass:"game-page__menu"},"game-page-menu",{score:e.scoreDelayed,onButtonNewGameClick:e.onButtonNewGameClick},!1)),a("game-page-cards",e._b({ref:"cards",staticClass:"game-page__cards"},"game-page-cards",{cards:e.cards,onCardClick:e.onCardClick},!1)),e._l(e.cardDisappearAnimations,function(e){return a("game-page-card-disappear-animation",{key:e.card.index,staticClass:"game-page__card-disappear-animation",attrs:{animation:e}})})],2):e._e()},g=[],v=a("5d73"),b=a.n(v),_=(a("96cf"),a("3b8d")),C=a("795b"),w=a.n(C),k=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"menu"},[a("button",{staticClass:"menu__button-new-game",attrs:{"data-tid":"Menu-newGame"},on:{click:e.onButtonNewGameClick}},[e._v("\n    Начать заново\n  ")]),a("span",{staticClass:"menu__scores-title"},[e._v("Очки:")]),a("span",{staticClass:"menu__scores-value",attrs:{"data-tid":"Menu-scores"}},[e._v(e._s(e.score))])])},y=[],x={name:"game-page-menu",props:["score","onButtonNewGameClick"]},G=x,P=(a("3dfa"),Object(p["a"])(G,k,y,!1,null,"7908efd8",null)),E=P.exports,R=a("d225"),O=a("b0b4"),j=a("75fc"),T=(a("6b54"),a("f5fe")),A=a.n(T),$=a("e0d5"),S=a.n($),D=3,M=6,N=42,F=600,B=5e3,I=500,L=100;function z(){for(var e=["C","D","H","S"],t=A()(2,10).map(function(e){return e.toString()}),a=["0"].concat(Object(j["a"])(t),["A","J","K","Q"]),n=[],r=0;r<e.length;r++){var i=e[r],s=!0,o=!1,c=void 0;try{for(var u,d=b()(a);!(s=(u=d.next()).done);s=!0){var l=u.value;n.push(l+i)}}catch(p){o=!0,c=p}finally{try{s||null==d.return||d.return()}finally{if(o)throw c}}}return n}var U=z(),K=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:M;if(Object(R["a"])(this,e),t*a%2!==0)throw new Error("Число карт на поле должно быть чётно");var n=t*a/2;if(n>U.length)throw new Error("Размер поля слишком большой. Не получится сделать так, чтобы у каждой карты была ровно одна пара");var r=S()(U).slice(0,n);this.cards=S()([].concat(Object(j["a"])(r),Object(j["a"])(r))),this.height=t,this.width=a,this.numberPairsAssociated=0,this.score=0}return Object(O["a"])(e,[{key:"flipPair",value:function(e,t){if(this.cards[e]===this.cards[t]){++this.numberPairsAssociated;var a=this.cards.length/2-this.numberPairsAssociated;return this.score+=N*a,!0}return this.score-=N*this.numberPairsAssociated,!1}},{key:"isGameEnd",value:function(){return this.numberPairsAssociated===this.cards.length/2}}]),e}(),J=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{ref:"cards",staticClass:"cards",attrs:{"data-tid":"Deck"}},e._l(e.cards,function(t){return a("div",{key:t.index,class:["cards__card card",{card_flipped:t.flipped,card_associated:t.associated}],attrs:{"data-tid":t.flipped?"Card-flipped":t.associated?null:"Card"},on:{mousedown:e.onMousedown,click:function(a){e.onCardClick(t)},keydown:[function(t){return"button"in t||!e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"])?e.blurActiveCard(t):null},function(a){if(!("button"in a)&&e._k(a.keyCode,"enter",13,a.key,"Enter"))return null;e.onCardClick(t)},function(a){if(!("button"in a)&&e._k(a.keyCode,"up",38,a.key,["Up","ArrowUp"]))return null;e.moveCardFocus(t,-1,0)},function(a){if(!("button"in a)&&e._k(a.keyCode,"down",40,a.key,["Down","ArrowDown"]))return null;e.moveCardFocus(t,1,0)},function(a){return"button"in a||!e._k(a.keyCode,"left",37,a.key,["Left","ArrowLeft"])?"button"in a&&0!==a.button?null:void e.moveCardFocus(t,0,-1):null},function(a){return"button"in a||!e._k(a.keyCode,"right",39,a.key,["Right","ArrowRight"])?"button"in a&&2!==a.button?null:void e.moveCardFocus(t,0,1):null}]}},[a("div",{staticClass:"card__inner",attrs:{tabindex:"0"}},[a("img",{staticClass:"card__frontside",attrs:{src:"static/cards/"+t.name+".png",alt:t.flipped?"карта "+t.name+", лицевая сторона":""}}),a("img",{staticClass:"card__backside",attrs:{src:"static/cards/backside.png",alt:t.flipped?"":"рубашка карты"}})])])}),0)},H=[],W=(a("f559"),{name:"game-page-cards",props:["cards","onCardClick"],mounted:function(){document.addEventListener("keydown",this.onKeydown)},beforeDestroy:function(){document.removeEventListener("keydown",this.onKeydown)},methods:{onMousedown:function(e){e.preventDefault()},onKeydown:function(e){(!document.activeElement||document.activeElement===document.body&&e.key.startsWith("Arrow"))&&this.focusCard(0)},moveCardFocus:function(e,t,a){var n=Math.floor(e.index/M),r=e.index%M,i=n+t,s=r+a;if(0<=i&&i<D&&0<=s&&s<M){var o=i*M+s;this.focusCard(o)}},focusCard:function(e){this.$refs.cards.children[e].firstElementChild.focus()},blurActiveCard:function(){document.activeElement.blur()}}}),Q=W,q=(a("f869"),Object(p["a"])(Q,J,H,!1,null,"cee60728",null)),V=q.exports,X=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"animation"},[a("img",{ref:"image",staticClass:"animation__image",style:{height:e.animation.height+"px",width:e.animation.width+"px"},attrs:{src:"static/cards/"+e.animation.card.name+".png",alt:"карта "+e.animation.card.name+", с анимацией исчезновения"}})])},Y=[],Z={name:"game-page-card-disappear-animation",props:["animation"],mounted:function(){this.$el.style.setProperty("--animation-start-top",this.animation.top+"px"),this.$el.style.setProperty("--animation-start-right",this.animation.right+"px"),this.$refs.image.classList.add("animation__image")}},ee=Z,te=(a("d2eb"),Object(p["a"])(ee,X,Y,!1,null,"417c913e",null)),ae=te.exports;function ne(e){return new w.a(function(t){return setTimeout(t,e)})}var re={name:"game-page",components:{GamePageMenu:E,GamePageCards:V,GamePageCardDisappearAnimation:ae},props:["moveToResultPage"],data:function(){return{gameId:0,game:null,cards:null,scoreDelayed:null,firstFlippedCard:null,cardDisappearAnimations:[]}},mounted:function(){var e=this;this.startNewGame(),this.$nextTick(function(){return e.onResize()}),window.addEventListener("resize",this.onResize)},beforeDestroy:function(){window.removeEventListener("resize",this.onResize)},methods:{startNewGame:function(){var e=Object(_["a"])(regeneratorRuntime.mark(function e(){var t,a,n,r,i,s,o;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=++this.gameId,this.game=new K,this.cards=this.game.cards.map(function(e,t){return{index:t,name:e,flipped:!0,associated:!1}}),this.scoreDelayed=0,this.firstFlippedCard=null,this.cardDisappearAnimations=[],e.next=8,ne(B);case 8:if(t!==this.gameId){e.next=28;break}for(a=!0,n=!1,r=void 0,e.prev=12,i=b()(this.cards);!(a=(s=i.next()).done);a=!0)o=s.value,o.flipped=!1;e.next=20;break;case 16:e.prev=16,e.t0=e["catch"](12),n=!0,r=e.t0;case 20:e.prev=20,e.prev=21,a||null==i.return||i.return();case 23:if(e.prev=23,!n){e.next=26;break}throw r;case 26:return e.finish(23);case 27:return e.finish(20);case 28:case"end":return e.stop()}},e,this,[[12,16,20,28],[21,,23,27]])}));function t(){return e.apply(this,arguments)}return t}(),onResize:function(){var e=document.documentElement.clientWidth,t=document.documentElement.clientHeight,a=.6*e,n=.8*t,r=.03*Math.min(e,t),i=Math.min((a-r*(M-1))/M/226,(n-r*(D-1))/D/314);this.$refs.cards&&this.$refs.cards.$el.style.setProperty("--card-scale",i)},onCardClick:function(){var e=Object(_["a"])(regeneratorRuntime.mark(function e(t){var a,n,r,i,s;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!t.flipped&&!t.associated){e.next=2;break}return e.abrupt("return");case 2:if(t.flipped=!0,null!==this.firstFlippedCard){e.next=6;break}return this.firstFlippedCard=t,e.abrupt("return");case 6:return a=this.firstFlippedCard,this.firstFlippedCard=null,n=this.game.score,r=this.gameId,e.next=12,ne(F);case 12:if(i=this.game.flipPair(t.index,a.index),s=this.game.score-n,!i){e.next=19;break}return e.next=17,this.disappearCardPair(t,a);case 17:e.next=21;break;case 19:return e.next=21,this.flipCardPair(t,a);case 21:r===this.gameId&&(this.scoreDelayed+=s);case 22:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),flipCardPair:function(){var e=Object(_["a"])(regeneratorRuntime.mark(function e(t,a){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ne(I);case 2:t.flipped=a.flipped=!1;case 3:case"end":return e.stop()}},e,this)}));function t(t,a){return e.apply(this,arguments)}return t}(),disappearCardPair:function(){var e=Object(_["a"])(regeneratorRuntime.mark(function e(t,a){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ne(L);case 2:return t.associated=a.associated=!0,t.flipped=a.flipped=!1,this.disappearCard(t),this.disappearCard(a),e.next=8,ne(800);case 8:this.game.isGameEnd()&&this.moveToResultPage(this.game.score);case 9:case"end":return e.stop()}},e,this)}));function t(t,a){return e.apply(this,arguments)}return t}(),disappearCard:function(e){var t=this.$refs.cards.$el.children[e.index],a=t.getBoundingClientRect(),n=this.$el.getBoundingClientRect(),r={card:e,top:a.top-n.top,right:n.right-a.right,height:a.height,width:a.width};this.cardDisappearAnimations.push(r)},onButtonNewGameClick:function(e){e.target.blur(),this.startNewGame()}}},ie=re,se=(a("8ac4"),Object(p["a"])(ie,h,g,!1,null,"02111398",null)),oe=se.exports,ce=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"result-page"},[a("img",{staticClass:"result-page__image responsive-image",attrs:{src:"static/images/EndGame.png",srcset:"static/images/EndGame.png 508w, static/images/EndGame@2x.png 1016w",sizes:"40vw",alt:"картинка из четырёх карт (лицевой стороной)"}}),a("h1",{staticClass:"result-page__header header"},[e._v("\n    Поздравляем!"),a("br"),e._v("\n    Ваш итоговый счёт: "+e._s(e.score)+"\n  ")]),a("button",{staticClass:"result-page__button-new-game button",attrs:{"data-tid":"EndGame-retryGame"},on:{click:e.onButtonRetryGameClick}},[e._v("\n    Ещё раз\n  ")])])},ue=[],de={name:"result-page",props:["score","moveToGamePage"],methods:{onButtonRetryGameClick:function(e){e.target.blur(),this.moveToGamePage()}}},le=de,pe=(a("d590"),Object(p["a"])(le,ce,ue,!1,null,"88f37b94",null)),me=pe.exports,fe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"placeholder"},[a("div",{staticClass:"placeholder__krungthep-font"},[e._v("0123456789-")]),a("div",{staticClass:"placeholder__open-sans-font-bold"},[e._v("Очки")]),e._l(e.allCards,function(e){return a("img",{staticClass:"placeholder__image",attrs:{src:"static/cards/"+e+".png"}})}),a("img",{staticClass:"placeholder__image",attrs:{src:"static/cards/backside.png"}}),a("img",{staticClass:"placeholder__image",attrs:{src:"static/images/EndGame.png",srcset:"static/images/EndGame.png 508w, static/images/EndGame@2x.png 1016w",sizes:"40vw"}})],2)},he=[],ge={name:"placeholder-for-preloading-images-and-font",data:function(){return{allCards:U}}},ve=ge,be=(a("af0a"),Object(p["a"])(ve,fe,he,!1,null,"1ceafd66",null)),_e=be.exports,Ce=o()({INTRO:0,GAME:1,RESULT:2}),we={name:"App",components:{PlaceholderForPreloadingImagesAndFont:_e,ResultPage:me,GamePage:oe,IntroPage:f},data:function(){return{state:Ce.INTRO,score:null,State:Ce}},methods:{moveToGamePage:function(){this.state=Ce.GAME},moveToResultPage:function(e){this.score=e,this.state=Ce.RESULT}}},ke=we,ye=(a("034f"),Object(p["a"])(ke,r,i,!1,null,null,null)),xe=ye.exports;a("f5df");n["a"].config.productionTip=!1,new n["a"]({el:"#app",render:function(e){return e(xe)}})},"64a9":function(e,t,a){},"8ac4":function(e,t,a){"use strict";var n=a("be60"),r=a.n(n);r.a},"8ee3":function(e,t,a){},af0a:function(e,t,a){"use strict";var n=a("1b93"),r=a.n(n);r.a},b927:function(e,t,a){},be60:function(e,t,a){},d2eb:function(e,t,a){"use strict";var n=a("8ee3"),r=a.n(n);r.a},d410:function(e,t,a){"use strict";var n=a("b927"),r=a.n(n);r.a},d590:function(e,t,a){"use strict";var n=a("3540"),r=a.n(n);r.a},e341:function(e,t,a){},f869:function(e,t,a){"use strict";var n=a("e341"),r=a.n(n);r.a}});
//# sourceMappingURL=app.3cacbac7.js.map